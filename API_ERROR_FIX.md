# Исправление ошибки 500 Internal Server Error в API

В этом документе описаны шаги по исправлению ошибки 500 (Internal Server Error) при обращении к API.

## Выполненные улучшения

Мы внесли следующие улучшения в код для повышения надежности API-запросов:

1. **Улучшена обработка ошибок**: Добавлена детальная информация об ошибках и автоматическое журналирование ошибок.
2. **Автоматические повторные попытки**: Добавлен механизм повторных попыток для 500 ошибок сервера.
3. **Резервные прямые запросы**: При сбое запроса через Next.js прокси система автоматически пытается обратиться напрямую к API.
4. **Добавлены диагностические инструменты**: Для упрощения отладки и выявления проблем.

## Как использовать диагностический инструмент

1. Откройте консоль браузера (F12 или Ctrl+Shift+J в Chrome/Firefox)
2. Скопируйте содержимое файла `frontend/public/diagnostic.js` и вставьте в консоль
3. Нажмите Enter для запуска диагностики
4. Следуйте инструкциям в консоли

## Часто встречающиеся проблемы и решения

### 1. Ошибка 500 при обращении к API

**Причины:**
- Временные проблемы с сервером
- Ошибка обработки данных в API
- Проблемы с сетевым подключением

**Решения:**
- Проверьте, запущен ли API-сервер (`docker ps`)
- Проверьте логи сервера на наличие ошибок
- Используйте прямое обращение к API (http://192.168.1.124:8088)

### 2. Некорректная конфигурация Next.js прокси

**Причины:**
- Неправильно настроены rewrite-правила в next.config.js
- Проблемы с CORS-политикой

**Решения:**
- Убедитесь, что в файле next.config.js корректно настроены rewrites
- Проверьте, что в API разрешены запросы с вашего домена

### 3. Проблемы с преобразованием данных

**Причины:**
- Некорректный формат запроса
- Ошибка в обработке данных на сервере

**Решения:**
- Проверьте структуру отправляемых данных
- Используйте диагностический инструмент для исследования ответов сервера

## Дополнительная информация

Если проблема сохраняется после всех исправлений:

1. Обратитесь к логам API-сервера для получения более детальной информации
2. Используйте команду: `docker logs football-stat-api --tail 50`
3. Проверьте подключение к базе данных
4. Используйте скрипт backend_diagnostic.py для проверки API напрямую 